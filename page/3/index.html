<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="chanlee, programming, mobile, arduino, ios, android, xamarin, linux" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="Computing and Programming issues">
<meta property="og:type" content="website">
<meta property="og:title" content="Programming Note">
<meta property="og:url" content="http://chanlee.github.io/page/3/index.html">
<meta property="og:site_name" content="Programming Note">
<meta property="og:description" content="Computing and Programming issues">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Programming Note">
<meta name="twitter:description" content="Computing and Programming issues">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '작성자'
    }
  };
</script>




  <link rel="canonical" href="http://chanlee.github.io/page/3/"/>


  <title> Programming Note </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="ko">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-46034286-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Programming Note</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">chanlee blog</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            홈
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            카테고리
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            아카이브
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            태그
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/28/anatomy-of-a-riot-framework-part-1/" itemprop="url">
                  Riot 프레임워크 알아보기. (1/6) 소개
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2016-07-28T23:56:22+09:00" content="2016-07-28">
              2016-07-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/28/anatomy-of-a-riot-framework-part-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/07/28/anatomy-of-a-riot-framework-part-1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://cdn.codevisually.com/wp-content/uploads/2013/11/riot.jpg" alt="riot logo"></p>
<h2 id="왜-Riot인가"><a href="#왜-Riot인가" class="headerlink" title="왜 Riot인가?"></a>왜 Riot인가?</h2><p><a href="http://riotjs.com/" target="_blank" rel="external">Riot</a>은 매우 작은 라이브러리이다. 이것이, 왜 Riot인지에 대한 답이다. 작다는것은 습득해야 할것도 적고, 버그도 적다는것으로 해석될 수 있다.</p>
<p>Riot은 사실 React에 많은 영향을 받아, React의 Light 버전 처럼 느껴진다. 또한, Polymer의 장점도 반영되었다. 전반적인 코드는 마치 “Javascript vs. Coffescript”를 보는것 처럼 간결하다.</p>
<p>바로 코디를 통해 Riot에 대해 살펴보겠다.</p>
<h2 id="커스텀-태크"><a href="#커스텀-태크" class="headerlink" title="커스텀 태크"></a>커스텀 태크</h2><p>모든 브라우저에서 Polymer처럼 커스텀 태그를 쓸 수 있다. 하지만, 컴포넌트의 생김새는 React와 유사하다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">todo</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Markup --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123; opts.title &#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">each</span>=<span class="string">&#123;</span> <span class="attr">item</span> <span class="attr">in</span> <span class="attr">items</span> &#125;&gt;</span>&#123; item &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&#123;</span> <span class="attr">add</span> &#125;&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span>&gt;</span>Add #&#123; items.length + 1 &#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Style --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></div><div class="line">        h3 &#123;</div><div class="line">            font-size: 14px;</div><div class="line">        &#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Logic --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">        this.items = []</div><div class="line"></div><div class="line">        add(e) &#123;</div><div class="line">            var input = e.target[0]</div><div class="line">            this.items.push(input.value)</div><div class="line">            input.value = ''</div><div class="line">        &#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">todo</span>&gt;</span></div></pre></td></tr></table></figure>
<p>별다른 해석이 없어도 위 컴포넌트의 기능을 이해하는데 별 어려움은 없을 것으로 보인다. 이 태그는 페이지에서 아래와 같이 사용될 수 있다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">todo</span>&gt;</span><span class="tag">&lt;/<span class="name">todo</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">riot.mount('todo')</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>React를 보신분들은 비슷한점을 많이 느낄것이다. 하지만, Riot은 훨씬 간결한 문법을 제공하고 es6와도 잘 맞는다. 비슷하지만 뭔가 다른다. <a href="http://riotjs.com/compare/" target="_blank" rel="external">riotjs 홈페이지의 React와의 비교</a> 페이지에 따르면 이것은 겉모습뿐만이 아니다.</p>
<p>Riot은 DOM파싱시에 모든 DOM Node의 Expression을 배열로 참조하고 있다가 변화가 생기는 노드에 대해서만 업데이트를 한다. 그런데, React와 달리 Riot은 HTML구조는 고정된다. 즉, div가 label로 변경될 수 없다. Riot은 단지, 참조하고 있는 Expression만 업데이트 하고, 그 하위 노드에 대한 복잡한 교체는 하지 않음으로써 DOM업데이트를 매우 빠르게 처리할 수 있다.</p>
<h1 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h1><p>Riot은 크게 Custom Tag, Event Observer, Router의 세가지를 기본적인 구성요소로 가지고 있다. 그리고, minimal한 기능을 제공함으로써 혼란을 줄이고 빠르게 개발에 집중할 수 있도록 한다.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/05/an-overview-of-app-engine/" itemprop="url">
                  마이크로 서비스 아키텍처의 관점에서본 구글 앱엔진
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2016-05-05T21:39:42+09:00" content="2016-05-05">
              2016-05-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Cloud/" itemprop="url" rel="index">
                    <span itemprop="name">Cloud</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/05/an-overview-of-app-engine/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/05/an-overview-of-app-engine/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<blockquote>
<p>Google의 <a href="https://cloud.google.com/appengine/docs/go/an-overview-of-app-engine" target="_blank" rel="external">“An Overview of App Engine”</a> 에서 일부를 정리했음.</p>
</blockquote>
</blockquote>
<h3 id="서비스-앱엔진을-구성하는-빌딩-블록"><a href="#서비스-앱엔진을-구성하는-빌딩-블록" class="headerlink" title="서비스: 앱엔진을 구성하는 빌딩 블록"></a>서비스: 앱엔진을 구성하는 빌딩 블록</h3><p>최상위 레벨의 관점에서 봤을때, 앱엔진 어플리케이션은 하나 또는 그 이상의 서비스로 이루어져 있다. 각 서비스들은 다른 런타임상에서 실행되거나 성능에 관한 설정을 달리 할 수 있다. 서비스는 개발자들이 커다란 어플리케이션을 논리적인 컴포넌트 단위로 쪼갤수 있게 해준다. 이것들은 서로 Memcache와 같은 앱엔진의 기능들을 공유하고, 상호 안전하게 커뮤니케이션할 수 있다.<br>결국 서비스는 마이크로서비스와 같은 형태를 취하며, 다수의 서비스들을 이용해 어플리케이션을 구성할 수 있다.<br>하나의 어플리케이션은 다음과 같은 다양한 고객의 요청사항을 각기 다른 서비스를 통해 처리할 수 있다.</p>
<ul>
<li>모바일 장치로 부터의 API 요청.</li>
<li>내부적인 작업. (관리자 기능)</li>
<li>백엔드 처리. (지불에 관련된 파이프라인 또는 데이터 분석)</li>
</ul>
<h3 id="버전과-인스턴스"><a href="#버전과-인스턴스" class="headerlink" title="버전과 인스턴스"></a>버전과 인스턴스</h3><p>각 서비는 소스코드와 설정파일로 이루어져 있다. 서비스에는 항상 버전이 따른다. 당신이 서비스를 배포한다는 것은 특정 버전의 서비스를 배포한다는 것을 의미한다. 각, 서비스가 버전을 가짐으로써 구글 클라우드 플랫폼 콘솔을 통해 언제든지 클릭한번으로 롤백하거나, 점진적으로 새로운 버전의 서비스로 트래픽을 증가시킬 수 도 있다.<br>운영중인 서비스의 특정 버전은 하나 또는 그 이상의 인스턴스를 가진다. 앱엔진은 실행중인 인스턴스를 앱의 성능과 부하량에 따라 자동으로 늘리거나 줄이는 기능을 제공해 쉬고있는 인스턴스(idle)을 최소화 하여 비용을 절감하도록 도와준다.<br>아래 다이어그램은 실행중인 앱엔진 어플리케이션의 계층도를 보여준다.<br><img src="https://cloud.google.com/appengine/docs/images/modules_hierarchy.png" alt="app engine hierarchy" title="App Engine Hierarchy"></p>
<h3 id="서비스간의-통신"><a href="#서비스간의-통신" class="headerlink" title="서비스간의 통신"></a>서비스간의 통신</h3><p>모든 서비스와, 버전, 인스턴스는 “v1.my-service.my-app.appspot.com” 과 같이 고유의 URI를 가지고 있다. 사용자의 요청은 <a href="https://cloud.google.com/appengine/docs/go/how-requests-are-routed" target="_blank" rel="external">URL 어드레싱 규칙</a>에 의해 특정 서비스/버전의 인스턴스로 라우팅된다.<br><a href="https://cloud.google.com/appengine/docs/go/urlfetch" target="_blank" rel="external">URL Fetch API</a>를 이용해 서비스간에 또는 외부의 엔드포인트로 요청을 전달할 수 있다.<br>모든 어플리케이션 서비스는 <a href="https://cloud.google.com/appengine/docs/go/datastore/" target="_blank" rel="external">데이터스토어</a>와 <a href="https://cloud.google.com/appengine/docs/go/memcache/" target="_blank" rel="external">Memcache</a>서비스의 상태를 공유한다. 또한, 서비스은 <a href="https://cloud.google.com/appengine/docs/go/taskqueue/" target="_blank" rel="external">Task Queue</a>를 이용해 작업을 할당하고 협업한다. 이러한, 공유 서비스에 접근하기 위해서는 상응하는 앱엔진 API를 사용해야 한다.</p>
<h2 id="제한"><a href="#제한" class="headerlink" title="제한"></a>제한</h2><p>서비스의 최대수는 앱의 가격정책에 따라 다르다.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/05/golang-binding-package/" itemprop="url">
                  Go 패키지 시리즈 2 바인딩(mholt/binding) 사용하기
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2016-05-05T21:25:27+09:00" content="2016-05-05">
              2016-05-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/GoLang/" itemprop="url" rel="index">
                    <span itemprop="name">GoLang</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/05/golang-binding-package/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/05/golang-binding-package/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://networkstatic.net/wp-content/uploads/2015/01/gopher.jpg" alt="net"></p>
<h3 id="소개"><a href="#소개" class="headerlink" title="소개"></a>소개</h3><p>Go의 net/http 패키지를 위한 데이터 바인딩 유틸리티로서 http.Request를 Go 구조체로 바인딩 한다.</p>
<h3 id="설치"><a href="#설치" class="headerlink" title="설치"></a>설치</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">go get github.com/mholt/binding</div></pre></td></tr></table></figure>
<h3 id="사용법"><a href="#사용법" class="headerlink" title="사용법"></a>사용법</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">myStruct := <span class="built_in">new</span>(MyStruct)</div><div class="line">errs := binding.Bind(req, myStruct)</div><div class="line"><span class="keyword">if</span> errs.Handle(response) &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>이렇게 바인딩하기 위해서는 구조체 MyStruct를 binding.FieldMap 인터페이스로 만들어야 한다. 이 과정은 간단히 func (s *MyStruct) FieldMap() binding.FieldMap 메소드를 구현하기만 하면 된다.<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *MyStruct)</span> <span class="title">FieldMap</span><span class="params">()</span> <span class="title">binding</span>.<span class="title">FieldMap</span></span> &#123;</div><div class="line">    <span class="keyword">return</span> binding.FieldMap&#123;</div><div class="line">        &amp;s.Name: <span class="string">"name"</span>, <span class="comment">// 구조체 필드: 폼이름</span></div><div class="line">        &amp;s.Email: <span class="string">"email"</span>,</div><div class="line">        &amp;s.Message: binding.Field&#123;</div><div class="line">        	Form: <span class="string">"message"</span>,</div><div class="line">        	Required: <span class="literal">true</span>, <span class="comment">// validation</span></div><div class="line">         &#125;,</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="More"><a href="#More" class="headerlink" title="More"></a>More</h3><p>(<a href="http://mholt.github.io/binding/)[http://mholt.github.io/binding/" target="_blank" rel="external">http://mholt.github.io/binding/)[http://mholt.github.io/binding/</a>]</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/21/golang-template-package/" itemprop="url">
                  Go 패키지 시리즈 1 템플릿 사용하기
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2016-04-21T01:45:35+09:00" content="2016-04-21">
              2016-04-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/GoLang/" itemprop="url" rel="index">
                    <span itemprop="name">GoLang</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/21/golang-template-package/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/21/golang-template-package/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>한동안 일에 치어서 블로깅에 소흘했는데 그 말인즉 공부를 안했다는 말인것 같다. 최근에 <a href="https://golang.org/" target="_blank" rel="external">Go</a>를 보고있는데 재미있어서 빠져드는 중이다. 요즘 트렌드인지 동시성(concurrency)에 상당히 강점을 가지면서 문법이 직관적이라 적응기간도 그리 길지 않은것 같다.</p>
<p>어제는 앱엔진에서 제공하는 도큐먼트를 보고 간단히 <a href="https://cloud.google.com/appengine/docs/go/gettingstarted/introduction" target="_blank" rel="external">guestbook</a>을 따라해 봤는데 템플릿에 대한 설명이 부족하길래 간만에 번역을 해보았다. 원문을 그대로 번역하진 않고 원문과 공식 Go문서를 번갈아 참고하며 정리했다.</p>
<p>글 내용중 좀 더 자세한 함수의 사용법에 대해서는 참고자료의 링크를 참고하도록 하자.</p>
<p><img src="http://i.imgur.com/lb8cQ3g.jpg?1" alt="test"></p>
<h2 id="템플릿이란"><a href="#템플릿이란" class="headerlink" title="템플릿이란?"></a>템플릿이란?</h2><p>대부분의 서버사이드 언어들은 정적인 페이지에 스크립팅을 지원하기 위한 언어들을 제공한다. JSP나 PHP 스크립팅 같은 것이 그런 예이다. Go에서는 이와 유사한 스크립팅 언어로 <a href="http://golang.org/pkg/text/template" target="_blank" rel="external">template</a> 패키지를 제공한다.</p>
<p>이 패키지는 다른 스크립트가 그러하든 정적인 텍스트에 리스트와 같은 오브젝트들을 결합하여 동적인 컨텐츠를 생산해낸다.</p>
<p>HTML을 만들어 내기 위해서는 <a href="https://golang.org/pkg/html/template/" target="_blank" rel="external">html/template</a> 라는 패키지를 사용한다. 이 패키지는 <a href="http://golang.org/pkg/text/template" target="_blank" rel="external">text/template</a> 패키지와 유사한 기능을 제공하며, 추가로 브라우저에서 보안상의 문제를 해결하고 이스케이프 문자와 같은것들을 안전하게 변환해 주는 기능을 포함하고 있다.</p>
<p>템플릿은 정적인 텍스트와 내장된 커맨드들로 구성된다. 커맨드는 JSP나 PHP와 유사하게 &#123;&#123; … &#125;&#125; 형식의 구분자로 표기된다.</p>
<p>템플릿에 Go객체가 적용되면, 당연히 템플릿내에서 이 객체의 필드들이 삽입될 수 있다. 템플릿에 적용된 Go객체는 “.”으로 표현된다. 즉, 이 객체가 문자열 이라면 &#123;&#123;.&#125;&#125; 으로 템플릿에 표시할 수 있다. 기본적으로 문자열 표시에는 fmt 패키지를 사용한다.</p>
<p>다음과 같은 구조체 객체가 있다<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</div><div class="line">    Name <span class="keyword">string</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>이 경우 이름을 표시하려면 &#123;&#123;.Name&#125;&#125; 과 같이 표현할 수 있다.</p>
<h2 id="정의-define"><a href="#정의-define" class="headerlink" title="정의(define)"></a>정의(define)</h2><p>결국, 템플릿은 변하지 않는 정적인 텍스트에 필요한 경우 특정 부분을 치환하기 위함이 목적이다. 이렇게 변하지 않은 부분을 정의할때 define문을 사용할 수 있다. define문은 “define”과 “end”사이에 템플릿을 선언하여 사용하면 된다.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">`&#123;&#123;define “T1”&#125;&#125;ONE&#123;&#123;end&#125;&#125;</div><div class="line">&#123;&#123;define “T2”&#125;&#125;TWO&#123;&#123;end&#125;</div><div class="line">&#123;&#123;define “T3”&#125;&#125;&#123;&#123;template “T1”&#125;&#125; &#123;&#123;template “T2”&#125;&#125;&#123;&#123;end&#125;&#125;</div><div class="line">&#123;&#123;template “T3”&#125;&#125;`</div></pre></td></tr></table></figure></p>
<p>이 예제에서 T1, T2 두개의 템플릿을 정의하고 T3는 이 두 템플릿을 사용하여 정의 하였다. 그리고, T3를 출력하여 “ONE TWO” 라는 결과를 출력하게 된다.</p>
<h2 id="병합-merge"><a href="#병합-merge" class="headerlink" title="병합(merge)"></a>병합(merge)</h2><p>template 패키지내의 Parse, ParseFile, Execute와 같은 메소드를 사용해서 템플릿을 로드하고, 그 후에 객체와 병합을 시도한다. 결국, 컨텐츠는 정의된 타입과 객체의 필드들을 이용하여 만들어 진다. 구조체 객체내 선언된 필드가 외부에 노출되기 위해서는 속성명은 대문자로 시작해야 한다.</p>
<h3 id="예제"><a href="#예제" class="headerlink" title="예제"></a>예제</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">        <span class="string">"os"</span></div><div class="line">        <span class="string">"text/template"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</div><div class="line">        <span class="comment">//exported field since it begins</span></div><div class="line">        <span class="comment">//with a capital letter</span></div><div class="line">        Name <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="comment">//define an instance</span></div><div class="line">        s := Student&#123;<span class="string">"Satish"</span>&#125;</div><div class="line"></div><div class="line">        <span class="comment">//create a new template with some name</span></div><div class="line">        tmpl := template.New(<span class="string">"test"</span>)</div><div class="line"></div><div class="line">        <span class="comment">//parse some content and generate a template</span></div><div class="line">        tmpl, err := tmpl.Parse(<span class="string">"Hello &#123;&#123;.Name&#125;&#125;!"</span>)</div><div class="line"></div><div class="line">        <span class="comment">//A common use of panic is to abort if a function</span></div><div class="line">        <span class="comment">//returns an error value that we don't know how to</span></div><div class="line">        <span class="comment">//(or want to) handle.</span></div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">                <span class="built_in">panic</span>(err)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//merge template 'tmpl' with content of 's'</span></div><div class="line">        err1 := tmpl.Execute(os.Stdout, s)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</div><div class="line">                <span class="built_in">panic</span>(err1)</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="소스-설명"><a href="#소스-설명" class="headerlink" title="소스 설명"></a>소스 설명</h2><ul>
<li>이름(test)과 함께 새로운 템플릿 할당</li>
<li>Parse는 문자열을 template객체로 변환</li>
<li>필드값을 출력값에 포함시키기 위해서는 필드값을 중괄호로 둘러싸야 합니다. 예제에서, &#123;&#123;.Name&#125;&#125;은 “Student” 인스턴스인 “s”의 “Name”필드를 가르킵니다.</li>
<li>panic은 내장된 함수로서 현재 흐름을 중단시키고 <a href="https://gobyexample.com/panic" target="_blank" rel="external">패니킹</a> 단계를 수행합니다. Panic은 panic함수를 직접 호출하여 시작될수 있다. 또한, 런타임 오류들 - 배열 인덱스를 잘못 탐색한 경우와 같은 - 에 의해서도 시작될 수 있다.</li>
<li><a href="https://golang.org/pkg/os/" target="_blank" rel="external">os.Stdout</a> 은 표준 출력을 가르키는 변수로 미리 정의되어 있다. os.Stdout은 <a href="https://golang.org/pkg/io/#Writer" target="_blank" rel="external">io.Writer</a>를 구현한다.</li>
<li>Execute는 파싱된 템플릿에 특정 데이터 객체를 병합하여 결과를 표준출력(os.Stdout) 으로 출력한다.</li>
<li>error는 interface타입으로 오류 조건에 따라 값이 적용되며, nil일 경우 오류가 없음을 의미한다. Go 코드는 error값을 이용해 비정상적인 상태를 모니터링 한다.</li>
</ul>
<h2 id="파이프라인-“-”"><a href="#파이프라인-“-”" class="headerlink" title="파이프라인 (“|”)"></a>파이프라인 (“|”)</h2><p>파이프라인은 “|”문자로 구분되는 명령어의 나열이다. 각 커맨드의 결과가 다음 커맨드의 마지막 인자로 넘어가 최종 커맨드에 의해 출력되는 값이 파이프라인의 값이 된다.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;"put" | printf "%s%s" "out" | printf "%q"&#125;&#125;</div></pre></td></tr></table></figure></p>
<h2 id="range-커맨드"><a href="#range-커맨드" class="headerlink" title="range 커맨드"></a>range 커맨드</h2><p>다음 코드를 person.go 라는 파일로 저장하고 실행해 보자.<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">        <span class="string">"os"</span></div><div class="line">        <span class="string">"text/template"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</div><div class="line">        Name   <span class="keyword">string</span></div><div class="line">        Emails []<span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> tmpl = <span class="string">`The name is &#123;&#123;.Name&#125;&#125;.</span></div><div class="line">&#123;&#123;range .Emails&#125;&#125;</div><div class="line">    His email id is &#123;&#123;.&#125;&#125;</div><div class="line">&#123;&#123;end&#125;&#125;</div><div class="line">`</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">        person := Person&#123;</div><div class="line">                Name:   <span class="string">"Satish"</span>,</div><div class="line">                Emails: []<span class="keyword">string</span>&#123;<span class="string">"satish@rubylearning.org"</span>, <span class="string">"satishtalim@gmail.com"</span>&#125;,</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        t := template.New(<span class="string">"Person template"</span>)</div><div class="line"></div><div class="line">        t, err := t.Parse(tmpl)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">                <span class="built_in">panic</span>(err)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        err = t.Execute(os.Stdout, person)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">                <span class="built_in">panic</span>(err)</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>range 커맨드는 person.Emails 슬라이스를 순환하면서 값을 출력한다.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">The name is Satish.</div><div class="line"></div><div class="line">    His email id is satish@rubylearning.org</div><div class="line"></div><div class="line">    His email id is satishtalim@gmail.com</div></pre></td></tr></table></figure></p>
<h2 id="변수"><a href="#변수" class="headerlink" title="변수"></a>변수</h2><p>template 패키지는 변수를 정의하고 사용할 수 있다. 위의 예제에서 이메일 주소앞에 이름을 함께 출력하려면 다음과 같이 코드를 수정할 수 있다.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;$name := .Name&#125;&#125;</div><div class="line">&#123;&#123;range .Emails&#125;&#125;</div><div class="line">    Name is &#123;&#123;$name&#125;&#125;, email is &#123;&#123;.&#125;&#125;</div><div class="line">&#123;&#123;end&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>range 스코프에서 .은 person.Email 이므로 person.Name을 사용하기 위해서는 해당 스코프 밖에서 미리 변수를 정의하고, range 스코프에서 사용하면 된다. 변수는 “$”를 접두사로 사용하여 $name := .Name 과 같이 정의하고 range 스코프 안에서 접근해 사용하면 된다.</p>
<h2 id="html-template"><a href="#html-template" class="headerlink" title="html/template"></a>html/template</h2><p><a href="http://golang.org/pkg/html/template/" target="_blank" rel="external">html/template</a>는 HTML결과를 출력하기 위한 템플릿 패키지이다. <a href="http://golang.org/pkg/text/template/" target="_blank" rel="external">text/template</a>과 사용법이 비슷하며, 코드 인젝션(code injection)으로부터 안전한 출력을 위한 함수들을 추가로 지원한다.</p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>Go의 template 패키지는 아쉽게도 Regular Expression과 같은 강력한 기능을 제공하지는 않는다. 하지만, 사용법이 간단하고 일반적인 텍스트 치환은 큰 불편없이 사용할 수 있으니 사용에 무리는 없어 보인다.</p>
<h2 id="참고자료"><a href="#참고자료" class="headerlink" title="참고자료"></a>참고자료</h2><p><a href="https://blog.joshsoftware.com/2014/03/14/learn-to-build-and-deploy-simple-go-web-apps-part-three/" target="_blank" rel="external">Learn to build and deploy simple Go Web Apps, Part Three</a><br><a href="http://golang.org/pkg/text/template" target="_blank" rel="external">text/template</a><br><a href="http://golang.org/pkg/html/template/" target="_blank" rel="external">html/template</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/14/Introduce-Swift-Optional/" itemprop="url">
                  스위프트 옵셔널 이해하기
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2015-06-14T01:46:29+09:00" content="2015-06-14">
              2015-06-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/IOS/" itemprop="url" rel="index">
                    <span itemprop="name">IOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/06/14/Introduce-Swift-Optional/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/06/14/Introduce-Swift-Optional/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="옵셔널-개요"><a href="#옵셔널-개요" class="headerlink" title="옵셔널 개요"></a>옵셔널 개요</h3><p>Swift에서 변수를 선언할때는 기본적으로 옵셔널이 아닌(non-optional)값을 지정해야 한다. 다시말해, 변수에는 반드시 nil 이 아닌(non-nil) 값을 할당 해야만 한다. 만일, 옵셔널이 아닌 변수에 nil 을 설정하려 하면 컴파일러는 nil값을 할당 할 수 없다고 오류를 발생시킬 것이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> message: <span class="type">String</span> = <span class="string">"Swift is awesome!"</span> <span class="comment">// OK</span></div><div class="line">message = <span class="literal">nil</span> <span class="comment">// compile-time error</span></div></pre></td></tr></table></figure>
<p>클래스에서 속성을 선언할 때에도 마챦가지 이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Messenger</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> message1: <span class="type">String</span> = <span class="string">"Swift is awesome!"</span> <span class="comment">// OK</span></div><div class="line">    <span class="keyword">var</span> message2: <span class="type">String</span> <span class="comment">// compile-time error</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>하지만, Objective-C 에서는 아래와 같이 nil을 설정해도 에러가 발생하지 않는다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="type">NSString</span> *message = @<span class="string">"Objective-C will never die!"</span>;</div><div class="line">message = <span class="literal">nil</span>;</div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Messenger</span> </span>&#123;</div><div class="line">    <span class="type">NSString</span> *message1 = @<span class="string">"Objective will never die!"</span>;</div><div class="line">    <span class="type">NSString</span> *message2;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>하지만, 이것은 스위프트에서 초기값 없이 속성 또는 변수를 선언할수 없다는 것을 의미하지 않는다. 스위프트는 옵셔널 타입을 사용해 값의 부재를 알릴 수 있다. 즉,  “?” 오퍼레이터를 타입선언 뒤에 추가하면 된다. 아래 예를 참고하라.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Messenger</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> message1: <span class="type">String</span> = <span class="string">"Swift is awesome!"</span> <span class="comment">// OK</span></div><div class="line">    <span class="keyword">var</span> message2: <span class="type">String</span>? <span class="comment">// OK</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="왜-옵셔널-Optionals-인가"><a href="#왜-옵셔널-Optionals-인가" class="headerlink" title="왜 옵셔널(Optionals) 인가?"></a>왜 옵셔널(Optionals) 인가?</h3><p>스위프트는 애플의 주장대로 타입-세이프한 언어라는것을 보여주는 사례중 하나이다. 앞서본 예제와 같이 옵셔널은 런타임시에 발생할 수 있는 에러들을 컴파일시에 체크할 수 있도록 한다. 옵셔널의 장점을 더 잘 이해할 수 있도록 아래의 Objective-C 메소드를 살펴 보자.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="type">NSString</span> *)findStockCode:(<span class="type">NSString</span> *)company &#123;</div><div class="line">    <span class="keyword">if</span> ([company isEqualToString:@<span class="string">"Apple"</span>]) &#123;</div><div class="line">        <span class="keyword">return</span> @<span class="string">"AAPL"</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([company isEqualToString:@<span class="string">"Google"</span>]) &#123;</div><div class="line">        <span class="keyword">return</span> @<span class="string">"GOOG"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>findStockCode 메소드는 Apple과 Google의 주식코드를 리턴하고, 그 외의 경우에는 nil을 리턴한다. 이 메소드는 아래와 같이 호출될 수 있다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="type">NSString</span> *stockCode = [<span class="keyword">self</span> findStockCode:@<span class="string">"Facebook"</span>]; <span class="comment">// nil is returned</span></div><div class="line"><span class="type">NSString</span> *text = @<span class="string">"Stock Code - "</span>;</div><div class="line"><span class="type">NSString</span> *message = [text stringByAppendingString:stockCode]; <span class="comment">// runtime error</span></div><div class="line"><span class="type">NSLog</span>(@<span class="string">"%@"</span>, message);</div></pre></td></tr></table></figure>
<p>이 코드는 문제없이 컴파일이 되겠지만 실행했을때는 런타임 오류를 발생하게 된다. 이 코드를 스위프트로 작성하면 아래와 같이 되며, 컴파일시에 오류를 발견할 수 있게 된다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">findStockCode</span><span class="params">(company: String)</span></span> -&gt; <span class="type">String</span>? &#123;</div><div class="line">   <span class="keyword">if</span> (company == <span class="string">"Apple"</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">"AAPL"</span></div><div class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (company == <span class="string">"Google"</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">"GOOG"</span></div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> stockCode:<span class="type">String</span>? = findStockCode(<span class="string">"Facebook"</span>)</div><div class="line"><span class="keyword">let</span> text = <span class="string">"Stock Code - "</span></div><div class="line"><span class="keyword">let</span> message = text + stockCode  <span class="comment">// compile-time error</span></div><div class="line"><span class="built_in">println</span>(message)</div></pre></td></tr></table></figure>
<p>stockCode는 문자열 또는 nil값일 수 있다. 옵셔널 문자열인 String?은 업랩(Unwrapped)되지 않았으므로, 이것을 수정할 수 있도록 에러를 발생한다. 이렇게 컴파일시에 nil 체크를 수행함으로써 잠재적인 에러를 탐지할 수 있다는것이 옵셔널의 장점이다.</p>
<p><img src="/assets/nullpointer-cartoon.jpg" alt="null pointer exception"></p>
<h3 id="옵셔널-꺼내기-Unwrapping-Optionals"><a href="#옵셔널-꺼내기-Unwrapping-Optionals" class="headerlink" title="옵셔널 꺼내기(Unwrapping Optionals)"></a>옵셔널 꺼내기(Unwrapping Optionals)</h3><p>위의 코드가 컴파일 될 수 있도록 하려면 아래와 같이 수정하면 된다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stockCode:<span class="type">String</span>? = findStockCode(<span class="string">"Facebook"</span>)</div><div class="line"><span class="keyword">let</span> text = <span class="string">"Stock Code - "</span></div><div class="line"><span class="keyword">if</span> stockCode &#123;</div><div class="line">    <span class="keyword">let</span> message = text + stockCode!</div><div class="line">    <span class="built_in">println</span>(message)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>스위프트에서 느낌표는 강제 언래핑(Unwrapping)을 할때 사용된다. if문으로 stockCode에 값이 있다는것을 확인했으므로, 위와 같이 옵셔널 변수에 !를 붙여 값을 꺼낼 수 있다.</p>
<p>하지만, 아래와 같이 stockCode에 대해 nil-체크를 하지 않고 Unwrapping을 하게되면 런타임 오류를 만나게 될것이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stockCode:<span class="type">String</span>? = findStockCode(<span class="string">"Facebook"</span>)</div><div class="line"><span class="keyword">let</span> text = <span class="string">"Stock Code - "</span></div><div class="line"><span class="keyword">let</span> message = text + stockCode!  <span class="comment">// runtime error</span></div></pre></td></tr></table></figure>
<h3 id="옵셔널-바인딩"><a href="#옵셔널-바인딩" class="headerlink" title="옵셔널 바인딩"></a>옵셔널 바인딩</h3><p>강제 언래핑(Forced Unwrapping)은 다른 언어에서 null-체크를 하는것과 그리 다르지 않다. 또한, 잠재적으로 런타임 오류를 발생시킬 수 있다. 옵셔널 바인딩은 옵셔널이 값을 가지고 있는지 아닌지를 체크하고, 값이 있을 경우 그것을 꺼내어 임시로 특정 상수(또는 변수)에 값을 보관하는 방법을 말한다.</p>
<p>예제보다 이것을 더 쉽게 설명할 수 없으므로, 바로 앞에 사용했던 코드를 옵셔널 바인딩을 적용하여 변경해 보겠다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stockCode:<span class="type">String</span>? = findStockCode(<span class="string">"Facebook"</span>)</div><div class="line"><span class="keyword">let</span> text = <span class="string">"Stock Code - "</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">let</span> tempStockCode = stockCode &#123;</div><div class="line">    <span class="keyword">let</span> message = text + tempStockCode</div><div class="line">    <span class="built_in">println</span>(message)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>“if let”(또는 if var 도 사용 가능) 구문은 두가지 의미를 내포하고 있다. 쉽게말해, “만일 stockCode가 값을 가지고 있다면, 이것을 꺼내서 (1)tempStockCode에 값을 대입하고, (2) 조건문 블록을 실행하라” 는 것을 의미 한다. 그렇지 않다면 조건문은 실행되지 않는다.<br>tempStockCode는 새로운 상수이므로 끝에 느낌표(!)를 사용할 필요가 없다.</p>
<p>위 코드는 아래와 같이 좀 더 축약 하여 코딩할 수 있다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> text = <span class="string">"Stock Code - "</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">var</span> stockCode = findStockCode(<span class="string">"Apple"</span>) &#123;</div><div class="line">    <span class="keyword">let</span> message = text + stockCode</div><div class="line">    <span class="built_in">println</span>(message)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>이 코드에서 stockCode 는 옵셔널이 아니란점에 주목하기 바란다.</p>
<h3 id="옵셔널-체이닝"><a href="#옵셔널-체이닝" class="headerlink" title="옵셔널 체이닝"></a>옵셔널 체이닝</h3><p>옵셔널 체이닝을 설명하기 전에 이전의 예제 소스를 아래와 같이 수정하겠다. 우리는 code와 price라는 옵셔널 속성을 가진 Stock 이라는 클래스를 새로 만들고, findStockCode 함수는 문자열 대신 Stock클래스를 리턴 하도록 수정할 것이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> code: <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> price: <span class="type">Double</span>?</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">findStockCode</span><span class="params">(company: String)</span></span> -&gt; <span class="type">Stock</span>? &#123;</div><div class="line">    <span class="keyword">if</span> (company == <span class="string">"Apple"</span>) &#123;</div><div class="line">        <span class="keyword">let</span> aapl: <span class="type">Stock</span> = <span class="type">Stock</span>()</div><div class="line">        aapl.code = <span class="string">"AAPL"</span></div><div class="line">        aapl.price = <span class="number">90.32</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> aapl</div><div class="line"></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (company == <span class="string">"Google"</span>) &#123;</div><div class="line">        <span class="keyword">let</span> goog: <span class="type">Stock</span> = <span class="type">Stock</span>()</div><div class="line">        goog.code = <span class="string">"GOOG"</span></div><div class="line">        goog.price = <span class="number">556.36</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> goog</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>아래 코드는 주식코드를 찾고, 100주를 사는데 필요한 금액을 출력한다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="keyword">let</span> stock = findStockCode(<span class="string">"Apple"</span>) &#123;</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> sharePrice = stock.price &#123;</div><div class="line">        <span class="keyword">let</span> totalCost = sharePrice * <span class="number">100</span></div><div class="line">        <span class="built_in">println</span>(totalCost)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>findStockCode()의 반환값은 옵셔널이므로, 옵셔널 바인등을 사용해 nul-체크를 하고 stock의 price 역시 옵셔널 이므로 다시 한번 if let~ 문을 사용하였다.</p>
<p>위 코드는 에러를 발생시키지 않지만, 중첩된 “if set” 문을 사용하는 대신 옵셔널 체이닝을 사용해 더 간단히 할 수 있다. 옵셔널 체인은 “?.” 오퍼레이터를 사용해 다수의 옵셔널을 체인으로 묶을 수 있다. 아래 코드는 옵셔널 체인을 사용해 수정한 코드이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="keyword">let</span> sharePrice = findStockCode(<span class="string">"Apple"</span>)?.price &#123;</div><div class="line">    <span class="keyword">let</span> totalCost = sharePrice * <span class="number">100</span></div><div class="line">    <span class="built_in">println</span>(totalCost)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>이제 코드가 더욱 간결해 졌다. 옵셔널 체인에 관한 더 다양한 예제는 애플의 <a href="https://developer.apple.com/library/prerelease/ios/documentation/swift/conceptual/swift_programming_language/OptionalChaining.html#//apple_ref/doc/uid/TP40014097-CH21-XID_312" target="_blank" rel="external">스위프트 가이드</a> 문서에서 찾을 수 있다.</p>
<h3 id="스위프트와-오브젝티브-C의-상호-운용성"><a href="#스위프트와-오브젝티브-C의-상호-운용성" class="headerlink" title="스위프트와 오브젝티브-C의 상호 운용성"></a>스위프트와 오브젝티브-C의 상호 운용성</h3><p>스위프트는 Objective-C의 API들과 잘 상호 작용하도록 설계되었다. UIKit이나 다른 프레임워크의 API들과 상호작용이 필요한 부분에서도 쉽게 옵셔널들을 만날 수 있다. 다음 코드는 테이블뷰를 구현할때 마주칠수 있는 옵셔널의 예이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">numberOfSectionsInTableView</span><span class="params">(tableView: UITableView?)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">     <span class="comment">// Return the number of sections.</span></div><div class="line">     <span class="keyword">return</span> <span class="number">1</span></div><div class="line"> &#125;</div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView?, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">     <span class="comment">// Return the number of rows in the section.</span></div><div class="line">     <span class="keyword">return</span> recipes.<span class="built_in">count</span></div><div class="line"> &#125;</div><div class="line"></div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView!, cellForRowAtIndexPath indexPath: NSIndexPath!)</span></span> -&gt; <span class="type">UITableViewCell</span>! &#123;</div><div class="line">     <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(<span class="string">"Cell"</span>, forIndexPath: indexPath) <span class="keyword">as</span> <span class="type">UITableViewCell</span></div><div class="line"></div><div class="line">     cell.textLabel.text = recipes[indexPath.row]</div><div class="line"></div><div class="line">     <span class="keyword">return</span> cell</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>ps. 원문중 번역이 생략되거나 축약한 부분도 있습니다.<br>더 자세한 부분은 아래의 원문과 애플의 스위프트 공식 문서를 참고하시기 바랍니다.</p>
<p><a href="http://www.appcoda.com/beginners-guide-optionals-swift/" target="_blank" rel="external">원문 : A Beginner’s Guide to Optionals in Swift</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/18/cron-expression-with-quartz-cron-trigger/" itemprop="url">
                  Quartz CronTrigger로 알아보는 Cron 표현식
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2014-01-18T17:18:34+09:00" content="2014-01-18">
              2014-01-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/01/18/cron-expression-with-quartz-cron-trigger/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2014/01/18/cron-expression-with-quartz-cron-trigger/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>최근에 회사에서 Quartz를 사용할 일이 생겨 Cron 표현식을 정리해 보았습니다. 자주 쓰는편이 아니라 필요할땐 대충 구글링 해서 베껴쓰곤 했었는데, 비록 몇페이 안되지만 정리하고 나니 뿌듯하네요. 표현식은 unix 시스템과도 사용법이 동일하니 관리자 분들도 이해하고 있으면 유용할 것 같습니다.</p>
<p><img src="/assets/chuleta-crontab1.png" alt="crontab"></p>
<h3 id="Quartz에서-SimpleTrigger와-CronTrigger"><a href="#Quartz에서-SimpleTrigger와-CronTrigger" class="headerlink" title="Quartz에서 SimpleTrigger와 CronTrigger"></a>Quartz에서 SimpleTrigger와 CronTrigger</h3><p>만약에, 작업(Job) 실행이 달력 개념을 기반으로 반복된다면 정확한 간격(Interval)을 사용하는 SimpleTrigger보다 CronTrigger가 더 유용하게 사용될 수 있습니다.<br>CronTrigger는 “매일 금요일 정오”, 또는 “매 주말 오전 9시”, “1월 한달간 매주 월요일, 수요일, 금요일 오전 9시에서 10시 사이 5분 간격”과 같이 스케줄을 설정할 수 있습니다.<br>물론, SimpleTrigger처럼 CronTrigger도 스케줄이 적용될 시작 시간과 만료 시간을 설정할수 있습니다.</p>
<h3 id="Cron-표현식-Expression"><a href="#Cron-표현식-Expression" class="headerlink" title="Cron 표현식(Expression)"></a>Cron 표현식(Expression)</h3><p>Cron표현식은 CronTrigger 인스턴스를 설정하는데 사용됩니다. Cron표현식은 7개의 단위 표현식으로 구성된 문자열 입니다. 각 단위는 스케줄을 세분화 하여 상세하게 기술합니다. 이 단위 표현식은 공백으로 구분됩니다.</p>
<ol>
<li>초(Seconds)</li>
<li>분(Minutes)</li>
<li>시(Hours)</li>
<li>일(Day-of-Month)</li>
<li>월(Months)</li>
<li>요일(Days-of-Week)</li>
<li>연도(Year) - optional</li>
</ol>
<p>이들을 조합한 Cron표현식은 “0 0 12 ? * WEB”와 같이 표현됩니다. 이것은 “매주 수요일 정오”를 의미 합니다. (연도는 생략)</p>
<p>각 단위 표현식은 범위나 목록을 가질 수 있습니다. 예를들어, 앞의 예제에서 수요일(WED)은 “MON-FRI”, “MON,WED,FRI” 또는 “MON-WED,SAT”와 같이 대채될 수 있습니다.</p>
<p>와일드카드 문자는 이 필드에서 가능한 “매번”을 표현합니다. 그러므로, 앞의 예제에서 “월(Month)”필드의 ‘’표시는 단순히 “매월”을 의미합니다. 요일(Day-of-Week)필드에 ‘’는 “한주동안 매일”을 의미합니다.</p>
<p>모든 필드는 검증할 수 있는 값의 집합으로 구성됩니다. 값은 명확하게 표현해야 합니다. 분과 초는 0에서 59사이의 숫자여야 하고, 시간은 0에서 23사이의 숫자여야 합니다. 일(Day-of-Month) 필드는 1-31사이의 어떤 숫자나 사용할 수 있습니다.</p>
<p>월(Months)는 숫자 0에서 11, 또는 물자열 JAN, FEB, MAR, APR, MAY, JUN. JUL, AUG, SEP, OCT, NOV, 그리고 DEC를 사용할 수 있습니다. 요일(Days-of-Week)은 1과 7(1=일요일)사이의 숫자를 사용하거나, 문자열 SUN, MON, TUE, WED, THU, FRI, 그리고, SAT를 사용할 수 있습니다.</p>
<p>“/” 문자는 값의 증가 표현에 사용될 수 있습니다. 예를들어, 분(Minutes) 필드에 ‘0/15’ 를 사용한다면, 이것은 “0분 부터 시작하여 (시간의) 매 15분 마다”를 의미합니다. 만약, 분(Minutes) 필드에 ‘3/20’을 사용한다면, “3분부터 시작하여 매 20분 마다”를 의미하므로, ‘3,23,43’을 분 필드에 나열한것과 같습니다. 미묘하게 주목할 점은 “/35”의 경우 “매 35분 마다”를 의미하지 않는다는 것입니다. 이것은, “0분부터 시작하여 매 35분 마다”이므로, 달리 표현하면 ‘0,35’를 나열한 것과 같습니다.</p>
<p>“?”문자는 일(day-of-month)와 요일(day-of-week) 필드에서만 허용됩니다. 이것은 “설정 값 없음”에 사용됩니다. “?”문자는 두 필드(일, 요일)중 하나만 설정할 경우에 나머지 필드에 유용하게 사용됩니다. 다음 섹션의 예제를 보면 이해가 쉬울 것입니다.</p>
<p>“L”문자는 일(day-of-month)과 요일(day-of-week) 필드에서만 허용됩니다. 이 문자는 “마지막(last)”의 첫글자에서 따왔습니다. 하지만, 두 필드에서 조금 다른 의미로 해석됩니다. 예를들어, “L”이 일(day-of-month) 필드에서 사용되었을 경우 “이달의 마지막 날”을 의미합니다. 1월이면 31일이 되고, 2월은 (윤년이 아닌경우)28일이 됩니다. 요일(day-of-week) 필드에서 사용될 경우에는 단순히 “7” 또는 “SAT”를 의미합니다. 하지만, “L”이 특정값의 뒤에 올경우, 이것은 “이달의 마지막 x요일”이 됩니다. 예를들어, “6L” 또는 “FRIL”은 “이달의 마지막 금요일”을 의미합니다. 또한, 마지막 날에서 특정 기간(offset)을 설정할 수도 있습니다. “L-3”과 같이 설정하면 “(이달의 마지막일로부터)3일전부터 마지막날 까지”의 기간을 의미합니다. “L”옵션을 사용할때, 값의 목록이나 범위를 명확히 하지 않을 경우 예상밖의 결과를 낳을 수 있으므로 주의가 필요합니다.</p>
<p>“W”는 주어진 날로부터 가장 가까운 평일(월요일~금요일)을 가르킵니다. 만일, “15W”라는 값을 일(day-of-month)필드에 설정하면, “이달의 15번째날에서 가장 가까운 평일”을 의미합니다.<br>“#”은 “이달의 n번째 X요일”을 가르킵니다. 예를들어, “6#3” 또는 “FRI#3”을 요일(day-of-week) 필드에 설정할 경우 이것은 “이달의 세번째 금요일”을 의미 합니다.</p>
<p>이제 몇가지 표현식 예제를 통해 확실히 의미를 파악하도록 하겠습니다.</p>
<h3 id="Cron-표현식-예제"><a href="#Cron-표현식-예제" class="headerlink" title="Cron 표현식 예제"></a>Cron 표현식 예제</h3><p>*매 5분 마다 실행</p>
<blockquote>
<p>“0 0/5 <em> </em> * ?”</p>
</blockquote>
<p>*10초뒤 5분마다 실행. (10:00:10 am, 10:05:10 am, …)</p>
<blockquote>
<p>“10 0/5 <em> </em> * ?”</p>
</blockquote>
<p>*매주 수요일과 금요일 10:30, 11:30, 12:30, 13:30 에 실행</p>
<blockquote>
<p>“0 30 10-13 ? * WED,FRI”</p>
</blockquote>
<p>*매월 5일, 20일 오전 8시부터 오전 10시 사이에 30분 간격으로 실행. 이 트리거는 10:00 am에는 실행이 되지 않고, 8:00, 8:30, 9:00, 9:30 에만 실행 된다.</p>
<blockquote>
<p>“0 0/30 8-9 5,20 * ?”</p>
</blockquote>
<p>어떤 스케줄링 작업은 너무 복잡한 트리거 표현식을 요구하기도 합니다. 이럴 경우에는 단순히 두개의 트리거로 나누어 작업을 등록하길 권장 합니다.</p>
<p>참고 페이지 : <a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-06" target="_blank" rel="external">Quartz Framework. Lesson 6: Cron Trigger</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/01/11/understand-javascript-iife/" itemprop="url">
                  Javascript IIFE 이해하기
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2014-01-11T16:44:07+09:00" content="2014-01-11">
              2014-01-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/01/11/understand-javascript-iife/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2014/01/11/understand-javascript-iife/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>IIFE(Immediately Invoked Function Expressions: “Iffy”라고 발음)는 즉시 호출 함수 표현식의 줄임말입니다.</p>
<p><img src="/assets/iife.jpg" alt="iife"></p>
<p>기본적인 형태는 다음과 같습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// Do fun stuff</span></div><div class="line">    &#125;</div><div class="line">)()</div></pre></td></tr></table></figure></p>
<p>이것은 즉시 호출되는 익명 함수 표현식 입니다. 이것은 자바스크립트에서 때에 따라 중요하게 사용될 수 있습니다.</p>
<h3 id="함수-선언-Declaration-과-표현-Expression"><a href="#함수-선언-Declaration-과-표현-Expression" class="headerlink" title="함수 선언(Declaration)과 표현(Expression)"></a>함수 선언(Declaration)과 표현(Expression)</h3><p>IIFE를 설명하기 전에 함수의 선언(Function Declaration)과 함수의 표현(Function Expression)의 차이점에 대해 이해할 필요가 있습니다. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope?redirectlocale=en-US&amp;redirectslug=JavaScript%2FReference%2FFunctions_and_function_scope#Defining_functions" target="_blank" rel="external">Mozilla Developer Site의 함수</a>에 대한 설명을 보면 함수 표현식은 선언과 동일한 문법을 가지고 단지 표현식에서는 함수명이 생략될 수 있다고만 기술하고 있습니다. 틀린말은 아니지만 사실 이 보다 좀 더 뚜렷한 형태와 동작의 차이점을 가지고 있습니다.</p>
<p>함수 선언(declaration)은 미리 자바 스크립트의 실행 컨텍스트(execution context)에 로딩 되어 있으므로 언제든지 호출할 수 있지만, 표현식(Expression)은 인터프리터가 해당 라인에 도달 하였을때만 실행이 됩니다.</p>
<p>즉, 함수 선언(declaration)을 조건(conditionally)에 따라 할당(assignment)하거나, 생성, 또는 괄호 연산자로 그루핑(grouping)하여 표현식으로 나타낼 수 있습니다. 다음 소스는 함수 정의(선언과 표현)의 차이를 간단히 보여주고 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">foo(); <span class="comment">// success!</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">'foo'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(); <span class="comment">// "foo" is not defined.</span></div><div class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">'foo'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">alert(foo); <span class="comment">// "foo" is not defined.</span></div><div class="line">(<span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;&#125;);</div><div class="line">alert(foo); <span class="comment">// "foo" is not defined.</span></div></pre></td></tr></table></figure></p>
<p>IIFE를 설명하기 위한 function declaration과 function expression의 설명은 이정도만 하겠습니다.</p>
<h4 id="즉시-호출-함수-표현식은-어떻게-작동하는가"><a href="#즉시-호출-함수-표현식은-어떻게-작동하는가" class="headerlink" title="즉시 호출 함수 표현식은 어떻게 작동하는가?"></a>즉시 호출 함수 표현식은 어떻게 작동하는가?</h4><ul>
<li>괄호쌍이 익명의 함수를 감싸서 함수 선언(declaration)을 함수 표현식(expression)으로 표현될 수 있습니다. 그러므로, 단순한 익명의 함수를 global 스코프에 선언하지 않고 어디서든 익명의 함수 표현식을 가질 수 있습니다.</li>
<li><p>따라서, 아래와 같은 표현식이 가능합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 괄호 사용 안함</span></div><div class="line">x = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"><span class="comment">// 괄호 사용</span></div><div class="line">(x = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;);</div><div class="line"><span class="comment">// 변수 x에는 함수의 값이 할당됩니다. 괄호로 둘러쌓인 함수는 익명의 함수 표현식이 됩니다.</span></div></pre></td></tr></table></figure>
</li>
<li><p>이와 유사하게 이름을 부여하고, 즉시 호출된 함수 표현식으로 생성할 수 도 있습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(showName = function (name) &#123;</div><div class="line">  console.log(name || &quot;No Name&quot;)</div><div class="line">  &#125;</div><div class="line">) (); // No Name</div><div class="line">showName(&quot;Rich&quot;); // Rich</div><div class="line">showName(); // No Name</div></pre></td></tr></table></figure>
</li>
<li><p>showName 함수는 선언과 동시에 실행이 되며, 이름이 있으므로 나중에 호출 할수도 있습니다.</p>
</li>
<li>하지만, 익명의 표현식은 나중에 다시 호출할 수 없습니다. 참조할 방법이 없기 때문입니다.</li>
<li>익명의 함수를 괄호안에(group context) 위치시킬 경우, 전체 그룹을 평가(evaluate)하고 값을 리턴합니다. 결국, 리턴값은 익명 함수 자신입니다.</li>
<li>마지막 두개의 괄호는 JS컴파일러에게 이 익명 함수를 바로 호출하라고 말합니다. 이것을 IIFE라고 부릅니다.</li>
</ul>
<h4 id="언제-IIFE를-사용하는가"><a href="#언제-IIFE를-사용하는가" class="headerlink" title="언제 IIFE를 사용하는가?"></a>언제 IIFE를 사용하는가?</h4><p><em>젼역 영역(Global Scope)를 오염 시키지 않기 위해서</em></p>
<p>IIFE를 사용하는 주된 이유는 변수를 전역(global scope)으로 선언하는 것을 피하기 위해서 입니다. 많은 JavaScript 라이브러리와 전문가들이 이 기법을 사용합니다. jQuery plugin개발자들 사이에서 특히 인기가 많습니다. JS어플리케이션의 Top-Level - main.js 또는 app.js와 같은 - 에서도 IIFE를 사용할 수 있습니다. 아래 코드는 지역 변수를 익명 함수로 위치시켜 외부와의 충돌을 방지할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// All the code is wrapped in the IIFE</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> firstName = “Richard”;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">init</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        doStuff (firstName);</div><div class="line">        <span class="comment">// code to start the application</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">doStuff</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// Do stuff here</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">doMoreStuff</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// Do more stuff here</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// Start the application</span></div><div class="line">    init ();</div><div class="line">&#125;) ();</div></pre></td></tr></table></figure></p>
<p>필요한 경우 마지막 괄호안에 외부 객체나 변수를 넣어 익명의 함수에 전달할 수 도 있습니다.</p>
<h5 id="조건문과-함께-사용하기"><a href="#조건문과-함께-사용하기" class="headerlink" title="조건문과 함께 사용하기"></a>조건문과 함께 사용하기</h5><p>잘 알려지지 않았지만, 복잡한 로직을 다룰때 조건에 따라 함수정의를 달리 하여 설정하고 호출 할 수도 있습니다. 이 기법은 때론 유용할 수도 있겠으나, 대채로 사용하지 않길 바랍니다. 프로그램의 전반적인 가독성을 떨어트리고 버그를 양산할 수 있습니다. 꼭 사용해야 한다면 들여쓰기를 충분히 하여 코드를 읽기 쉽도록 유지하시기 바랍니다.</p>
<h5 id="클로저에서-값의-중복-현상-해결"><a href="#클로저에서-값의-중복-현상-해결" class="headerlink" title="클로저에서 값의 중복 현상 해결"></a>클로저에서 값의 중복 현상 해결</h5><p><a href="http://chanlee.github.io/2013/12/10/understand-javascript-closure/">자바스크립트 클로저 쉽게 이해하기</a> 에서 다루었던것 처럼, 순환문내에서 클로저 사용시 IIFE 기법을 사용해 참조에 의한 클로저의 오작동을 해결할 수 있습니다.</p>
<p>IIFE기법은 이제 많은 JS프레임워크들이나 오픈소스에서 쉽게 찾아볼 수 있습니다. JS코딩을 하면서 아직 이 기법에 대해 잘 모르거나 쓰고 있지만, 어떻게 작동하고 왜 사용하는지 모르고 있다면 이 글이 이해를 돕는데 조금이나마 도움이 되었길 바랍니다.</p>
<p>더 자세한 정보는 아래 참고 사이트의 글들을 참고 하시기 바랍니다.</p>
<p><a href="http://javascriptissexy.com/12-simple-yet-powerful-javascript-tips/" target="_blank" rel="external">12 Simple (Yet Powerful) JavaScript Tips</a><br><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope?redirectlocale=en-US&amp;redirectslug=JavaScript%2FReference%2FFunctions_and_function_scope#Defining_functions" target="_blank" rel="external">Functions and function scope</a><br><a href="http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/#question-about-surrounding-parentheses" target="_blank" rel="external">ECMA-262-3 in details</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/12/10/javascript-variable-scope-and-hoisting/" itemprop="url">
                  자바스크립트의 변수범위와 호이스팅
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2013-12-10T16:17:23+09:00" content="2013-12-10">
              2013-12-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/12/10/javascript-variable-scope-and-hoisting/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/12/10/javascript-variable-scope-and-hoisting/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>이 글에서, 우리는 자바스크립트 변수의 범위(scope)와 호이스팅(hoisting), 그리고 이 두가지의 특징에 관해 배워보겠습니다.</p>
<p><img src="/assets/js-scope.jpg" alt="scope image"></p>
<p>자바스크립트의 변수범위와 호이스팅이 작동하는 원리를 이해하는것은 필수적입니다. 이 두가지 컨셉은 직관적이면서도 이해하기가 쉽지 않습니다. 거기에는 미묘한 차이가 있으며, 자바스크립트 프로젝트에서 성공하기 위해서는 반드시 이해해야 합니다.</p>
<h3 id="변수-범위-Variable-Scope"><a href="#변수-범위-Variable-Scope" class="headerlink" title="변수 범위 (Variable Scope)"></a>변수 범위 (Variable Scope)</h3><p>변수 범위는 변수가 존재하는 컨텍스트입니다. 이것은 어디에서 변수에 접근할 수 있는지, 그 컨텍스트에서 변수에 접근할 수 있는지를 명시적으로 나타납니다.</p>
<p>변수는 지역 범위(local scope)와 전역 범위(global scope) 둘 중 하나를 가집니다.</p>
<h4 id="지역-변수-함수-수준-범위"><a href="#지역-변수-함수-수준-범위" class="headerlink" title="지역 변수 (함수 수준 범위)"></a>지역 변수 (함수 수준 범위)</h4><p>대부분의 프로그래밍 언어와 달리, 자바스크립트는 블럭-수준(block-level)의 범위를 가지고 있지 않습니다. 대신, 자바스크립트는 함수-수준(function-level)의 범위를 가집니다. 함수내에 정의된 변수는 지역 범위를 가지며, 해당 함수와 내부 함수에서만 접근이 가능합니다. 내부 함수에서 외부 함수의 변수 접근에 관한 더 자세한 내용은 클로저(Closure)를 설명한 글을 참조하시기 바랍니다.</p>
<p><em>함수-수준 범위의 예제</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"Richard"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> name = <span class="string">"Jack"</span>; <span class="comment">// 지역 변수; showName()함수에서만 접근가능.</span></div><div class="line">     <span class="built_in">console</span>.log(name); <span class="comment">// Jack</span></div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(name); <span class="comment">// Richard : 전역 변수</span></div></pre></td></tr></table></figure></p>
<p><em>잘못된 예제. (블럭-수준 범위로 오해할 경우)</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"Richard"</span>;</div><div class="line"><span class="comment">// 아래의 if문은 name변수에 대한 지역-범위를 생성하지 않습니다.</span></div><div class="line"><span class="keyword">if</span> (name) &#123;</div><div class="line">     name = <span class="string">"Jack"</span>;</div><div class="line">     <span class="built_in">console</span>.log(name); <span class="comment">// Jack : 전역 변수</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// name은 여전히 전역변수이며 if문에서 변경되었습니다.</span></div><div class="line"><span class="built_in">console</span>.log(name); <span class="comment">// Jack</span></div></pre></td></tr></table></figure></p>
<p><em>지역변수를 선언하지 않는다면 문제를 일으킬 가능성이 높아집니다.</em></p>
<p>항상 지역변수를 사용하기 이전에 선언하도록 하십시오. JSHint를 사용하면 코드의 문법 오류나 스타일을 체크할 수 있습니다. 다음은 지역변수를 선언하지 않음으로 인해 문제가 발생한 경우입니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 지역변수를 var키워드로 선언하지 않았을 경우, 그것은 전역-범위(global-scope)가 됩니다.</span></div><div class="line"><span class="keyword">var</span> name = <span class="string">"Michael Jackson"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showCelebrityName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(name);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showOrdinaryPersonName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     name = <span class="string">"Johnny Evers"</span>;</div><div class="line">     <span class="built_in">console</span>.log(name);</div><div class="line">&#125;</div><div class="line">showCelebrityName(); <span class="comment">// Michael Jackson</span></div><div class="line"></div><div class="line"><span class="comment">// name 은 지역변수가 아닙니다. 이것은 전역변수 name을 변경해 버립니다.</span></div><div class="line">showOrdinaryPersonName(); <span class="comment">// Johnny Evers</span></div><div class="line"></div><div class="line"><span class="comment">// 이제 전역변수 name은 Johny Evers입니다. 더이상, 셀럽의 이름은 없습니다. -.-;;</span></div><div class="line">showCelebrityName(); <span class="comment">// Johnny Evers</span></div><div class="line"></div><div class="line"><span class="comment">// 해결책은 지역변수 선언시 var 키워드를 사용하는 것입니다.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showOrdinaryPersonName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> name = <span class="string">"Johnny Evers"</span>; <span class="comment">// 이제 name은 항상 지역변수이며, 전역변수를 덮어쓰지 않습니다.</span></div><div class="line">     <span class="built_in">console</span>.log(name);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><em>지역번수는 함수내에서 전역번수보다 높은 우선순위를 가집니다.</em></p>
<p>만약, 같은 이름의 전역변수와 지역변수가 존재할 경우 이 변수를 함수내에서 사용한다면, 지역변수가 우선권을 갖게 됩니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"Paul"</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> name = <span class="string">"Jack"</span>;</div><div class="line">     <span class="built_in">console</span>.log(name);</div><div class="line">&#125;</div><div class="line">users(); <span class="comment">// Jack</span></div></pre></td></tr></table></figure></p>
<h4 id="전역-변수"><a href="#전역-변수" class="headerlink" title="전역 변수"></a>전역 변수</h4><p>함수의 외부에서 선언된 모든 변수는 전역 범위(global scope)를 가집니다. 브라우저에서, 전역 컨텍스트(또는 scope)는 window 객체를 가리킵니다.</p>
<p>그러므로, 전역변수는 전체 어플리케이션에서 사용이 가능합니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 전역변수는 아래와 같이 선언될 수 있습니다.</span></div><div class="line"><span class="keyword">var</span> myName = <span class="string">"Richard"</span>;</div><div class="line"><span class="comment">// 또는</span></div><div class="line">firstName = <span class="string">"Richard"</span>;</div><div class="line"><span class="comment">// 또는</span></div><div class="line"><span class="keyword">var</span> name;</div><div class="line">name;</div></pre></td></tr></table></figure></p>
<p>모든, 전역 변수는 window객체와 연결됩니다. 그러므로, 아래와 같이 window객체를 통해 모든 전역 변수에 접근이 가능합니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.myName); <span class="comment">// Richard</span></div><div class="line"><span class="comment">// 또는</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"myName"</span> <span class="keyword">in</span> <span class="built_in">window</span>); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"firstName"</span> <span class="keyword">in</span> <span class="built_in">window</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<p>만약, 변수가 최초 선언 없이(var 키워드를 사용하여) 초기화 되었다면, 이 변수는 자동으로 전역 컨텍스트에 추가됩니다:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showAge</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="comment">// age는 전역 변수입니다.</span></div><div class="line">     age = <span class="number">90</span>;</div><div class="line">     <span class="built_in">console</span>.log(age);</div><div class="line">&#125;</div><div class="line">showAge(); <span class="comment">// 90</span></div><div class="line"><span class="comment">// age는 전역 변수이므로, 이런식으로도 호출될 수 있습니다.</span></div><div class="line"><span class="built_in">console</span>.log(age); <span class="comment">// 90</span></div></pre></td></tr></table></figure></p>
<p>아래의 firtName은 둘다 전역 범위입니다. 두번째, firstName은 {} 블럭으로 쌓여있지만, 자바 스크립트는 블럭단위 범위를 지원하지 않는다는 것을 기억하기 바랍니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> firstName = <span class="string">"Richard"</span>;</div><div class="line">&#123;</div><div class="line">     <span class="keyword">var</span> firstName = <span class="string">"Bob"</span>;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(firstName); <span class="comment">// Bob</span></div></pre></td></tr></table></figure></p>
<p>다른 예제:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">10</span>; i++) &#123;</div><div class="line">     <span class="built_in">console</span>.log(i); <span class="comment">// 1~10까지 출력</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 변수 i는 전역 변수입니다. 그러므로, 아래 함수 호출시 i는 for문에서 실행된 후 마지막 값을 가르키게 됩니다.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">aNumber</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line">aNumber(); <span class="comment">// 11</span></div></pre></td></tr></table></figure></p>
<p><em>setTimeout 변수는 전역 범위에서 실행됩니다.</em></p>
<p>setTimeout 안에서 선언된 모든 함수는 전역 범위에서 실행됩니다. 다음 예제를 주의해서 보십시오.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// setTimeout 함수내에서 사용된 "this"객체는 myObj가 아니라, window객체를 참조합니다.</span></div><div class="line"><span class="keyword">var</span> highValue = <span class="number">200</span>;</div><div class="line"><span class="keyword">var</span> constantVal = <span class="number">2</span>;</div><div class="line"><span class="keyword">var</span> myObj = &#123;</div><div class="line">     <span class="attr">highValue</span>: <span class="number">20</span>,</div><div class="line">     <span class="attr">constantVal</span>: <span class="number">5</span>,</div><div class="line">     <span class="attr">calculateIt</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">          setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">               <span class="built_in">console</span>.log(<span class="keyword">this</span>.constantVal * <span class="keyword">this</span>.highValue);</div><div class="line">          &#125;, <span class="number">2000</span>);</div><div class="line">     &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 전역변수인 highValue와 constantVal을 사용하여 계산됩니다. 200*2.</span></div><div class="line">myObj.calculateIt(); <span class="comment">//400</span></div></pre></td></tr></table></figure>
<p><em>전역 범위를 오염시키지 마십시오</em></p>
<p>자바스크립트 전문가가 되려면, 가급적 전역 범위에 변수를 생성하는것을 피하도록 해야 합니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 다음 두 변수는 전역 범위에 있습니다.</span></div><div class="line"><span class="keyword">var</span> firstName, lastName;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fullName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"Full Name : "</span> + firstName + <span class="string">" "</span> + lastName);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>다음은, 개선된 코드로서 전역범위를 덜 오염시킵니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 함수내에 선언함으로서 이것은 지역변수 입니다.</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fullName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> firstName = <span class="string">"Michael"</span>, lastName = <span class="string">"Jackson"</span>;</div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"Full Name : "</span> + firstName + <span class="string">" "</span> + lastName);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>위의, 예제에서 fullName() 함수 역시 전역 범위에 있습니다.</p>
<h3 id="변수-호이스팅-Variable-Hoisting"><a href="#변수-호이스팅-Variable-Hoisting" class="headerlink" title="변수 호이스팅(Variable Hoisting)"></a>변수 호이스팅(Variable Hoisting)</h3><p>모든 변수선언은 호이스트 됩니다. 호이스트란, 변수의 정의가 그 범위에 따라 선언과 할당으로 분리되는 것을 의미합니다. 즉, 변수가 함수내에서 정의되었을 경우 선언이 함수의 최상위로, 함수 바깥에서 정의되었을 경우는 전역 컨텍스트의 최상위로 변경됩니다.</p>
<p>변수의 선언이 초기화나 할당시에 발생하는것이 아니라, 최상위로 호이스트 된다는 것을 명심해야 합니다. 다음 코드를 주목하십시오.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"First Name : "</span> + name);</div><div class="line">     <span class="keyword">var</span> name = <span class="string">"Ford"</span>;</div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"Last Name : "</span> + name);</div><div class="line">&#125;</div><div class="line">showName();</div><div class="line"><span class="comment">// First Name : undefined</span></div><div class="line"><span class="comment">// Last Name : Ford</span></div><div class="line"><span class="comment">// First Name이 undefined인 이유는 지역변수 name이 호이스트 되었기 때문입니다.</span></div></pre></td></tr></table></figure></p>
<p>이 코드는 자바스크립트 엔진에 의해 다음과 같이 해석됩니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">var</span> name; <span class="comment">// name 변수는 호이스트 되었습니다. 할당은 이후에 발생하기 때문에, 이 시점에 name의 값은 undefined 입니다.</span></div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"First name : "</span> + name); <span class="comment">// First Name : undefined</span></div><div class="line">     name = <span class="string">"Ford"</span>; <span class="comment">// name에 값이 할당 되었습니다.</span></div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"Last Name : "</span> + name); <span class="comment">// Last Name : Ford</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>호이스트 되었을때, 함수 선언은 변수선언을 덮어 씁니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 다음 두 변수와 함수는 myName으로 이름이 같습니다.</span></div><div class="line"><span class="keyword">var</span> myName; <span class="comment">// string</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"Rich"</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 함수 선언은 변수명을 덮어 씁니다.</span></div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> myName); <span class="comment">// function</span></div></pre></td></tr></table></figure></p>
<p>하지만, 변수에 값이 할당될 경우에는 반대로 변수가 함수선언을 덮어 씁니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myName = <span class="string">"Richard"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="string">"Rich"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> myName); <span class="comment">//string</span></div></pre></td></tr></table></figure>
<p>“strict mode”에서 최초의 선언없이 변수에 값을 할당하려 한다면 오류가 발생합니다. 변수에 값을 할당 하려 할때는 항상 미리 선언하는 습관을 들이는것이 좋습니다.</p>
<blockquote>
<p>이 글은 javascriptissexy.com의 허락을 받아 번역 하였습니다. 상업적인 목적이 아니라면 얼마든지 퍼가셔도 좋습니다. 단, 원문과 번역의 차이가 다소 있을 수 있으므로 번역글과 함께 아래 원문 사이트 주소도 항상 첨부해 주시기 바랍니다. 그외 오역이나 개선될 문장이 있다면 트위터 멘션이나 댓글, 이메일등 어떤 경로로든 알려주시면 바로 잡도록 하겠습니다.</p>
</blockquote>
<p><a href="http://javascriptissexy.com/javascript-variable-scope-and-hoisting-explained/" target="_blank" rel="external">Javascript variable scope and hoisting explained</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/12/10/understand-javascript-closure/" itemprop="url">
                  자바스크립트 클로저 쉽게 이해하기
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2013-12-10T15:54:14+09:00" content="2013-12-10">
              2013-12-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/12/10/understand-javascript-closure/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/12/10/understand-javascript-closure/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>클로저(Closure)는 프로그래머가 창조적이고 인상적이며 간결한 프로그래밍을 할 수 있게 해줍니다. 클로저는 빈번하게 사용되며 자바스크립트 스킬과 관계없이 자주 마주치게 될 것입니다. 물론, 지금 당장 클로저는 복잡해 보일 수 있습니다만, 이 글을 읽고 클로저에 대해 이해하게 된다면 자바스크립트 코딩시에 매일 사용하게 될 것입니다.</p>
<p>이 글은 비교적 클로저에 대해 간략히 설명하고 있습니다. 이 글을 계속 읽기전에 먼저 자바 스크립트의 변수 범위에 대해 이해할 필요가 있습니다. 만약, 그렇지 못하다면 블로그의 자바스크립트 변수의 범위와 호이스팅에 관한 글을 먼저 읽어 주시기 바랍니다.</p>
<p><img src="/assets/closure.jpg" alt="closure"></p>
<h3 id="클로저란-무엇인가"><a href="#클로저란-무엇인가" class="headerlink" title="클로저란 무엇인가"></a>클로저란 무엇인가</h3><p>클로저는 외부함수(포함하고 있는)의 변수에 접근할 수 있는 내부 함수를 일컫습니다. 스코프 체인(scope chain)으로 표현되기도 합니다. 클로저는 세가지 스코프 체인을 가집니다: 클로저 자신에 대한 접근(자신의 블럭내에 정의된 변수), 외부 함수의 변수에 대한 접근, 그리고 전역 변수에 대한 접근. 이렇게 3단계로 구분할 수 있습니다.</p>
<p>내부 함수는 외부 함수의 변수뿐만 아니라 파라미터에도 접근할 수 있습니다. 단, 내부 함수는 외부 함수의 arguments 객체를 호출할 수는 없습니다. (하지만, 외부 함수의 파라미터는 직접 호출할 수 있습니다.)</p>
<h4 id="기본적인-클로저-예제"><a href="#기본적인-클로저-예제" class="headerlink" title="기본적인 클로저 예제:"></a>기본적인 클로저 예제:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params">firstName, lastName</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> nameIntro = <span class="string">"Your name is "</span>;</div><div class="line">    <span class="comment">// 이 내부 함수는 외부함수의 변수뿐만 아니라 파라미터 까지 사용할 수 있습니다.</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">makeFullName</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> nameIntro + firstName + <span class="string">" "</span> + lastName;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> makeFullName();</div><div class="line">&#125;</div><div class="line">showName(<span class="string">"Michael"</span>, <span class="string">"Jackson"</span>); <span class="comment">// Your name is Michael Jackson</span></div></pre></td></tr></table></figure>
<p>클로저는 Node.js의 비동기, 논-블록킹 아키텍처의 핵심기능으로 활용되고 있습니다. 클로저는 jQuery에서도 빈번히 사용되며, 거의 모든 자바스크립트 코드에서 볼 수 있습니다.</p>
<h4 id="jQuery의-전형적인-클로저-사용예"><a href="#jQuery의-전형적인-클로저-사용예" class="headerlink" title="jQuery의 전형적인 클로저  사용예:"></a>jQuery의 전형적인 클로저  사용예:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> selections = [];</div><div class="line">    $(<span class="string">".niners"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 이 클로저는 selections 변수에 접근합니다.</span></div><div class="line">        selections.push(<span class="keyword">this</span>.prop(<span class="string">"name"</span>)); <span class="comment">// 외부 함수의 selections 변수를 갱신함</span></div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="클로저-규칙과-부수-효과"><a href="#클로저-규칙과-부수-효과" class="headerlink" title="클로저 규칙과 부수 효과"></a>클로저 규칙과 부수 효과</h3><p><em>클로저는 외부함수가 리턴된 이후에도 외부함수의 변수에 접근할수 있습니다.</em></p>
<p>클로저를 사용하면서 가장 헷갈리는것 중의 하나는 외부함수가 리턴된 이후에도 여전히 내부함수가 외부함수의 변수에 접근하고 있다는 것입니다. (네. 당신이 바로 읽은것 맞습니다.-.-) 자바스크립트의 함수가 실행되었을때, 함수는 자신이 생성되었을때와 동일한 스코프 체인을 사용합니다. 그러므로, 당신은 내부 함수를 나중에 호출할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">celebrityName</span>(<span class="params">firstName</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> nameIntro = <span class="string">"This is celebrity is "</span>;</div><div class="line">    <span class="comment">// 이 내부 함수는 외부함수의 변수와 파라미터에 접근할 수 있습니다.</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">lastName</span>(<span class="params">theLastName</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> nameIntro + firstName + <span class="string">" "</span> + theLastName;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> lastName;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> mjName = celebrityName(<span class="string">"Michael"</span>); <span class="comment">// 여기서 celebrityName 외부함수가 리턴됩니다.</span></div><div class="line"><span class="comment">// 외부함수가 위에서 리턴된 후에, 클로저(lastName)가 호출됩니다.</span></div><div class="line"><span class="comment">// 아직, 클로저는 외부함수의 변수와 파라미터에 접근 가능합니다.</span></div><div class="line">mjName(<span class="string">"Jackson"</span>); <span class="comment">// This celebrity is Michael Jackson</span></div></pre></td></tr></table></figure></p>
<p><em>클로저는 외부 함수의 변수에 대한 참조를 저장합니다.</em></p>
<p>클로저는 실제 값을 저장하지 않습니다. 클로저가 호출되기 전에 외부함수의 변수가 변경되었을때, 클로저는 더 흥미로워 집니다. 그리고, 이 강력한 기능은 창의적인 방법으로 활용될 수 있습니다. 아래의 내부(private) 변수예제는 더글라스 크락포드(Douglas Crockford)에 의해 처음 시연되었습니다:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">celebrityID</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> celebrityID = <span class="number">999</span>;</div><div class="line">    <span class="comment">// 우리는 몇개의 내부 함수를 가진 객체를 리턴할것입니다.</span></div><div class="line">    <span class="comment">// 모든 내부함수는 외부변수에 접근할 수 있습니다.</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">getID</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="comment">// 이 내부함수는 갱신된 celebrityID변수를 리턴합니다.</span></div><div class="line">            <span class="comment">// 이것은 changeThdID함수가 값을 변경한 이후에도 celebrityID의 현재값을 리턴합니다.</span></div><div class="line">            <span class="keyword">return</span> celebrityID;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">setID</span>: <span class="function"><span class="keyword">function</span>(<span class="params">theNewID</span>) </span>&#123;</div><div class="line">            <span class="comment">// 이 내부함수는 외부함수의 값을 언제든지 변경할 것입니다.</span></div><div class="line">            celebrityID = theNewID;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> mjID = celebrityID(); <span class="comment">// 이 시점에, celebrityID외부 함수가 리턴됩니다.</span></div><div class="line">mjID.getID(); <span class="comment">// 999</span></div><div class="line">mjID.setID(<span class="number">567</span>); <span class="comment">// 외부함수의 변수를 변경합니다.</span></div><div class="line">mjID.getID(); <span class="comment">// 567; 변경된 celebrityID변수를 리턴합니다.</span></div></pre></td></tr></table></figure></p>
<h3 id="클로저-비꼬기"><a href="#클로저-비꼬기" class="headerlink" title="클로저 비꼬기"></a>클로저 비꼬기</h3><p>클로저가 갱신된 외부함수의 변수에 접근함으로써, 외부 함수의 변수가 for문에 의해 변경될 경우 의도치 않은 버그가 발생할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">celebrityIDCreator</span>(<span class="params">theCelebrities</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> i;</div><div class="line">    <span class="keyword">var</span> uniqueID = <span class="number">100</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;theCelebrities.length; i++) &#123;</div><div class="line">        theCelebrities[i][<span class="string">"id"</span>] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> uniqueID + i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> theCelebrities;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> actionCelebs = [&#123;<span class="attr">name</span>:<span class="string">"Stallone"</span>, <span class="attr">id</span>:<span class="number">0</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">"Cruise"</span>, <span class="attr">id</span>:<span class="number">0</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">"Willis"</span>, <span class="attr">id</span>:<span class="number">0</span>&#125;];</div><div class="line"></div><div class="line"><span class="keyword">var</span> createIdForActionCelebs = celebrityIDCreator(actionCelebs);</div><div class="line"></div><div class="line"><span class="keyword">var</span> stalloneID = createIdForActionCelebs[<span class="number">0</span>];</div><div class="line"><span class="built_in">console</span>.log(stalloneID.id); <span class="comment">// 103</span></div></pre></td></tr></table></figure></p>
<p>위의 예제에서, 익명의 내부함수가 실행될 시점에 i의 값은 3입니다(배열의 크기만큼 증가한 값). 숫자 3은 uniqueID에 더해져 모든 celebritiesID에 103을 할당합니다. 그래서, 기대(100,101,102)와 달리 모든 리턴된 배열의 id=103이 됩니다.</p>
<p>이런 결과가 나타난 이유는, 앞서 언급했듯이 클로저는(이 예제에서 내부의 익명함수) 외부 변수에 대해 값이 아닌 참조로 접근하기 때문입니다. 즉, 클로저는 최종 갱신된 변수(i)에 대해서만 접근할 수 있으므로, 외부 함수가 전체 for문을 실행하고 리턴한 최종 i의 값을 리턴하게 됩니다. 100+3=103.</p>
<p>이런 부작용을 고치기 위해서 “즉시 호출된 함수 표현식(Immediately Invoked Function Expression. IIFE)”를 사용할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">celebrityIDCreator</span>(<span class="params">theCelebrities</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> i;</div><div class="line">    <span class="keyword">var</span> uniqueID = <span class="number">100</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;theCelebrities.length; i++) &#123;</div><div class="line">        theCelebrities[i][<span class="string">"id"</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">j</span>) </span>&#123;</div><div class="line">            <span class="comment">// j 파라미터는 호출시 즉시 넘겨받은(IIFE) i의 값이 됩니다.</span></div><div class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="comment">// for문이 순환할때마다 현재 i의 값을 넘겨주고, 배열에 저장합니다.</span></div><div class="line">                <span class="keyword">return</span> uniqueID + j;</div><div class="line">            &#125; () <span class="comment">// 함수의 마지막에 ()를 추가함으로써 함수를 리턴하는 대신 함수를 즉시 실행하고 그 결과값을 리턴합니다.</span></div><div class="line">        &#125; (i); <span class="comment">// i 변수를 파라미터로 즉시 함수를 호출합니다.</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> theCelebrities;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> actionCelebs = [&#123;<span class="attr">name</span>:<span class="string">"Stallone"</span>, <span class="attr">id</span>:<span class="number">0</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">"Cruise"</span>, <span class="attr">id</span>:<span class="number">0</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">"Willis"</span>, <span class="attr">id</span>:<span class="number">0</span>&#125;];</div><div class="line"></div><div class="line"><span class="keyword">var</span> createIdForActionCelebs = celebrityIDCreator(actionCelebs);</div><div class="line"></div><div class="line"><span class="keyword">var</span> stalloneID = createIdForActionCelebs[<span class="number">0</span>];</div><div class="line"><span class="built_in">console</span>.log(stalloneID.id); <span class="comment">// 100</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> cruiseID = createIdForActionCelebs[<span class="number">1</span>];</div><div class="line"><span class="built_in">console</span>.log(cruiseID.id); <span class="comment">// 101</span></div></pre></td></tr></table></figure></p>
<p>이 글은 javascriptissexy.com의 허락을 받아 번역 하였습니다. 상업적인 목적이 아니라면 얼마든지 퍼가셔도 좋습니다. 단, 원문과 번역의 차이가 다소 있을 수 있으므로 번역글과 함께 아래 원문 사이트 주소도 항상 첨부해 주시기 바랍니다. 그외 오역이나 개선될 문장이 있다면 트위터 멘션이나 댓글, 이메일등 어떤 경로로든 알려주시면 바로 잡도록 하겠습니다.</p>
<p><a href="http://javascriptissexy.com/understand-javascript-closures-with-ease/" target="_blank" rel="external">Understand JavaScript Closures With Ease</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/11/27/require-js/" itemprop="url">
                  RequireJS 살펴보기
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">작성일</span>
            <time itemprop="dateCreated" datetime="2013-11-27T14:58:06+09:00" content="2013-11-27">
              2013-11-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index">
                    <span itemprop="name">Javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/11/27/require-js/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/11/27/require-js/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>RequireJS는 자바스크립트 코드를 모듈화 하고, 모듈간의 종속성을 깔끔하게 해결해 줍니다. Java나 Python과 같은 일반적인 언어들의 경우 언어 측면에서 기본적인 모듈화 방안을 제공합니다만, 자바스크립트의 경우 기본적으로 글로벌 네임스페이스를 공유함으로 신경써서 관리하지 않으면 유지보수가 어려워 집니다. RequireJS는 비단 브라우저 환경 뿐만 아니라, NodeJS와 같은 환경에서도 활용될 수 있으므로, 스크립트 최적화와 관리에 큰 도움이 될 것입니다.  </p>
<p>이 글은 <a href="http://requirejs.org/docs/api.html" target="_blank" rel="external">requirejs.org</a>의 문서 내용을 기반으로 정리하였습니다. 번역 과정에서 일부 생략하고 의역한 부분이 있습니다. 번역 자체가 목적이 아니라 정리와 학습을 목적으로 함으로 좀 더 상세한 내용을 알고 싶으신 분은 원문을 참고 하시기 바랍니다.  </p>
<p><img src="/assets/requirejs-logo.svg" alt="requirejs logo"></p>
<h3 id="자바스크립트-파일-로딩"><a href="#자바스크립트-파일-로딩" class="headerlink" title="자바스크립트 파일 로딩"></a>자바스크립트 파일 로딩</h3><p>RequireJS는 기존의 <code>&lt;script&gt;</code>태그 방식과 다르게 스크립트를 로딩합니다. RequireJS의 궁극적인 목적은 자바스크립트 코드를 모듈화 하는 것입니다. 아울러 lazy-loading을 통해서 스크립트 로딩을 최적화 합니다. 그렇기 때문에, RequireJS에서는 스크립트를 URL이 아닌 모듈ID를 사용해 로딩합니다.  </p>
<p>RequireJS는 모든 코드를 baseUrl에 상대경로 표시합니다. baseUrl은 보통 data-main 속성에서 사용한 경로와 같습니다. data-main 속성은 Requirejs에서 사용하는 특수한 속성으로서 진입점 역할을 합니다.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"scripts/main.js"</span> <span class="attr">src</span>=<span class="string">"scripts/require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>위 코드에서 baseUrl은 결국 scripts 디렉토리가 됩니다.  </p>
<blockquote>
<p>baseUrl은 추후 config에서 변경할 수도 있습니다. 위 예는 일반적으로 사용하는 기본값입니다. RequireJS는 모든 종속성이 스크립트로 간주되므로 모듈ID에 “.js”확장자를 생략할 수 있습니다.</p>
</blockquote>
<p>경우에 따라 위와 같이 “baseUrl + path” 규칙 대신 좀 더 유연한 방식으로 경로를 설정할 수도 있습니다. 예를들어, 사용자정의 스크립트 모듈들과 써드파티 스크립트 모듈들을 구별하고 싶을경우 아래와 같이 디렉토리 레이아웃을 설정할 수 있습니다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">www/</div><div class="line">  index.html</div><div class="line">  js/</div><div class="line">    app/</div><div class="line">      sub.js</div><div class="line">    lib/</div><div class="line">      jquery.js</div><div class="line">      canvas.js</div><div class="line">    app.js</div><div class="line">    require.js</div></pre></td></tr></table></figure></p>
<p>디렉토리 구조가 위와 같이 구성되어 있고, index.html에 아래와 같이 스크립트 로딩이 정의되어 있을 경우<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"js/app.js"</span> <span class="attr">src</span>=<span class="string">"js/require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>app.js가 아래와 같이 작성되어 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">requirejs.config(&#123;</div><div class="line">    <span class="attr">baseUrl</span>: <span class="string">'js/lib'</span>,</div><div class="line">    <span class="attr">paths</span>: &#123;</div><div class="line">        <span class="attr">app</span>: <span class="string">'../app'</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">requirejs([<span class="string">'jquery'</span>, <span class="string">'canvas'</span>, <span class="string">'app/sub'</span>],</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">$, canvas, sub</span>) </span>&#123;</div><div class="line">        <span class="comment">// jQuery, canvas, app/sub 모듈이 모두 로딩되고</span></div><div class="line">        <span class="comment">// 이곳에서 부터 사용할 수 있습니다.</span></div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h4 id="data-main-진입점"><a href="#data-main-진입점" class="headerlink" title="data-main 진입점"></a>data-main 진입점</h4><p>app.js는 스크립트 로딩의 진입점이자, 비동기로 모듈을 로딩합니다. 그러므로, index.html에 아래와 같이 스크립트 로딩을 정의할 경우 에러를 발생시킵니다.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"scripts/main"</span> <span class="attr">src</span>=<span class="string">"scripts/require.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"scripts/other.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><em>main.js:</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">    <span class="attr">paths</span>: &#123;</div><div class="line">        <span class="attr">foo</span>: <span class="string">'libs/foo-1.1.3'</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><em>other.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>( [<span class="string">'foo'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"> foo </span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>이 코드는 require.config()가 실행되기 전에 호출됩니다. 그러므로, requirejs는 ‘scripts/libs/foo-1.1.3.js’ 대신, ‘scripts/foo.js’를 로딩하려 합니다.</p>
<h4 id="require-config"><a href="#require-config" class="headerlink" title="require.config"></a>require.config</h4><p>이런경우 require.config()를 require.js를 HTML페이지의 앞부분에서 로딩할수도 있습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"scripts/require.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">&lt;script&gt;</div><div class="line">    <span class="built_in">require</span>.config(&#123;</div><div class="line">        <span class="attr">baseUrl</span>: <span class="string">"/another/path"</span>,</div><div class="line">        <span class="attr">paths</span>: &#123;</div><div class="line">            <span class="attr">foo</span>: <span class="string">'libs/foo-1.1.3'</span>,</div><div class="line">            <span class="attr">some</span>: <span class="string">'some/v1.0'</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="built_in">require</span>( [<span class="string">'foo'</span>, <span class="string">'my/module'</span>, <span class="string">'some/module'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"> foo, myModule, someModule </span>) </span>&#123;</div><div class="line"></div><div class="line">    &#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<h5 id="설정-옵션"><a href="#설정-옵션" class="headerlink" title="설정 옵션"></a>설정 옵션</h5><ul>
<li>baseUrl : 모듈을 검색하기 위한 루트경로 입니다. 위 예제의 경우 “my/module”의 script경로는 “/another/path/my/module.js” 가 됩니다.</li>
<li>paths :* 모듈 경로를 alias와 같이 제공합니다. 위 예제에서 require()의 인자에 포함된 ‘foo’는 script경로 “/another/path/libs/foo-1.1.3.js”를 가르킵니다. ‘some/module’은 실제 ‘/another/path/some/v1.0/module.js’를 가르킵니다.</li>
<li>shim : define()으로 정의되지 않는 기존의 <code>&lt;script&gt;</code> 스타일의 스크립트들에 대한 의존성 주입 설정 입니다.</li>
</ul>
<p>아래 예제는 requirejs 2.1.0이상과 backbone.js, underscore.js,와 jQuery는 baseUrl디렉토리를 사용하게 될것이다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">requirejs.config(&#123;</div><div class="line">    <span class="attr">shim</span>: &#123;</div><div class="line">        <span class="string">'backbone'</span>: &#123;</div><div class="line">            <span class="attr">deps</span>: [<span class="string">'underscore'</span>, <span class="string">'jquery'</span>],</div><div class="line">            <span class="comment">//module value.</span></div><div class="line">            exports: <span class="string">'Backbone'</span></div><div class="line">        &#125;,</div><div class="line">        <span class="string">'underscore'</span>: &#123;</div><div class="line">            <span class="attr">exports</span>: <span class="string">'_'</span></div><div class="line">        &#125;,</div><div class="line">        <span class="string">'foo'</span>: &#123;</div><div class="line">            <span class="attr">deps</span>: [<span class="string">'bar'</span>],</div><div class="line">            <span class="attr">exports</span>: <span class="string">'Foo'</span>,</div><div class="line">            <span class="attr">init</span>: <span class="function"><span class="keyword">function</span> (<span class="params">bar</span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.Foo.noConflict();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>이후에 다른 js모듈에서 backbone을 다음과 같이 사용할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define([<span class="string">'backbone'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">Backbone</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> Backbone.Model.extend(&#123;&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h6 id="map"><a href="#map" class="headerlink" title="map"></a>map</h6><p>프로젝트가 커질 경우 특정 모듈을 개선하면서, 의존하는 모듈의 버전이 변경되었다고 가정할 수 있습니다. 이경우, 기존 버전에 의존하는 모듈과 개선된 모듈이 의존하는 모듈의 버전이 달라질 수 있습니다. 하지만, 아직 이 두 모듈이 프로젝트 내에서 공존해야 할경우 config에서 map설정을 통해 해결할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">requirejs.config(&#123;</div><div class="line">      <span class="attr">map</span>: &#123;</div><div class="line">           <span class="string">'*'</span>: &#123;</div><div class="line">                <span class="string">'foo'</span>: <span class="string">'foo1.2'</span></div><div class="line">           &#125;,</div><div class="line">           <span class="string">'some/oldmodule'</span>: &#123;</div><div class="line">                <span class="string">'foo'</span>: <span class="string">'foo1.0'</span></div><div class="line">           &#125;</div><div class="line">      &#125;</div><div class="line"> &#125;);</div></pre></td></tr></table></figure></p>
<p> ‘some/oldmodule’을 제외한 모든 모듈에 “foo1.2”가 사용됩니다.</p>
<h5 id="config"><a href="#config" class="headerlink" title="config"></a>config</h5><p> 모듈에 환경설정등 사용자 정의값이 필요할 경우에 config 속성을 사용할 수 있습니다.<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">requirejs.config(&#123;</div><div class="line">     <span class="attr">config</span>: &#123;</div><div class="line">          <span class="string">'bar'</span>: &#123;</div><div class="line">               <span class="attr">size</span>: <span class="string">'large'</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">'baz'</span>: &#123;</div><div class="line">               <span class="attr">color</span>: <span class="string">'blue'</span></div><div class="line">          &#125;</div><div class="line">     &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p> 이경우, bar.js 모듈에서는 module.config().size를, baz.js 모듈에서는 module.config().color를 사용할 수 있습니다.</p>
<h5 id="waitSeconds"><a href="#waitSeconds" class="headerlink" title="waitSeconds"></a>waitSeconds</h5><p> 스크립트 로딩에 대한 타임아웃 시간입니다. 0은 disable이며, 기본값은 7초 입니다.</p>
<h5 id="deps"><a href="#deps" class="headerlink" title="deps"></a>deps</h5><p> requre.js가 로딩되기전 config객체에서 의존성이 필요할 경우, 로딩할 의존성 목록을 배열로 나열합니다.</p>
<h3 id="모듈-정의하기"><a href="#모듈-정의하기" class="headerlink" title="모듈 정의하기"></a>모듈 정의하기</h3><p>모듈은 well-scoped한 객체를 선언하고 종속되는 모듈들의 리스트를 명시적으로 기술함으로써 글로벌 네임스페이스가 오염되는것을 방지합니다. 하나의 모듈당 하나의 js파일을 작성해야 합니다. 모듈을은 최적화 도구에 의해 하나의 번들(optimized bundles)로 그룹핑될 수도 있습니다.</p>
<h4 id="단순한-이름-값-형태의-모듈-정의"><a href="#단순한-이름-값-형태의-모듈-정의" class="headerlink" title="단순한 이름/값 형태의 모듈 정의"></a>단순한 이름/값 형태의 모듈 정의</h4><p>어떤 종속성도 가지지 않으며 단순한 이름/값 형태의 컬렉션이라면, 객체 상수를 define()함수에 작성하기만 하면 됩니다.</p>
<p><em>my/shirt.js:</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">define(&#123;</div><div class="line">    <span class="attr">color</span>: <span class="string">"black"</span>,</div><div class="line">    <span class="attr">size</span>: <span class="string">"unisize"</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="함수-정의"><a href="#함수-정의" class="headerlink" title="함수 정의"></a>함수 정의</h4><p>모듈이 setup등의 사전 작업이 필요한 경우, 작업을 마친후 define()함수의 마지막 부분에서 함수를 리턴해 주면 됩니다.</p>
<p><em>my/shirt.js:</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//Do setup work here</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">color</span>: <span class="string">"black"</span>,</div><div class="line">        <span class="attr">size</span>: <span class="string">"unisize"</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="종속성과-함께-함수-정의"><a href="#종속성과-함께-함수-정의" class="headerlink" title="종속성과 함께 함수 정의"></a>종속성과 함께 함수 정의</h4><p>모듈이 종속성을 가질경우, define()함수의 첫번째 인자로 종속될 모듈들을 배열형태로 서술합니다. 그리고, 전달한 배열 순서대로 정의한 함수객체의 인자로 받아서 해당 모듈을 사용할 수 있습니다. 이 경우 새로 정의한 모듈은 종속된 모듈을 모두 한번 로딩한 다음 함수객체를 리턴하게 됩니다. my/shirt.js: cart와 inventory라는 모듈에 의존합니다. 의존 모듈을은 모두 shirts.js와 같은 디렉토리에 존재합니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">define([<span class="string">"./cart"</span>, <span class="string">"./inventory"</span>], <span class="function"><span class="keyword">function</span>(<span class="params">cart, inventory</span>) </span>&#123;</div><div class="line">    <span class="comment">//return an object to define the "my/shirt" module.</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">color</span>: <span class="string">"blue"</span>,</div><div class="line">        <span class="attr">size</span>: <span class="string">"large"</span>,</div><div class="line">        <span class="attr">addToCart</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            inventory.decrement(<span class="keyword">this</span>);</div><div class="line">            cart.add(<span class="keyword">this</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="함수-모듈-정의"><a href="#함수-모듈-정의" class="headerlink" title="함수 모듈 정의"></a>함수 모듈 정의</h4><p>모듈의 함수는 어떤 객체든지 리턴할 수 있습니다. 다음 모듈은 모듈정의에서 함수를 리턴합니다. foo/title.js: 이 모듈은 cart와 inventory모듈에 의존성을 갖습니다. 이 모듈들은 다른 디렉토리(my/)에 존재하므로 의존성 주입시 “my/cart, my/inventory”를 명시해 줍니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">define([<span class="string">"my/cart"</span>, <span class="string">"my/inventory"</span>],</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">cart, inventory</span>) </span>&#123;</div><div class="line">        <span class="comment">//return a function to define "foo/title".</span></div><div class="line">        <span class="comment">//It gets or sets the window title.</span></div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">title</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> title ? (<span class="built_in">window</span>.title = title) :</div><div class="line">                   inventory.storeName + <span class="string">' '</span> + cart.name;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h4 id="CommonJS-모듈을-포함한-모듈-정의"><a href="#CommonJS-모듈을-포함한-모듈-정의" class="headerlink" title="CommonJS 모듈을 포함한 모듈 정의"></a>CommonJS 모듈을 포함한 모듈 정의</h4><p>CommonJS 모듈 형태로 작성된 코드는 단순히 CommonJS Wrapper를 사용해 정의할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>),</div><div class="line">            b = <span class="built_in">require</span>(<span class="string">'b'</span>);</div><div class="line"></div><div class="line">        <span class="comment">//Return the module value</span></div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>이때, define()에 전달되는 함수의 인자(require, exports, module)의 순서는 항상 위와 동일하여야 합니다.</p>
<h4 id="모듈에-이름-부여하기"><a href="#모듈에-이름-부여하기" class="headerlink" title="모듈에 이름 부여하기"></a>모듈에 이름 부여하기</h4><p>define() 함수 호출시 첫번째 인자에 모듈명을 부여할 수 있습니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//명시적으로 "foo/title"이라는 이름을 부여함.</span></div><div class="line">define(<span class="string">"foo/title"</span>,</div><div class="line">    [<span class="string">"my/cart"</span>, <span class="string">"my/inventory"</span>],</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">cart, inventory</span>) </span>&#123;</div><div class="line">        <span class="comment">//Define foo/title object in here.</span></div><div class="line">   &#125;</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>이런 모듈명은 통상 “최적화 도구”에 의해 생성됩니다. 명시적으로 모듈명을 부여하는 것은 파일의 이동등에 따른 호환성(portability)을 떨어트리게 할 수 있으므로 가급적 사용을 자제하고, 최적화 도구를 이용해 생성되도록 합니다. 명시적인 모듈명은 스크립트 로딩을 빠르게 합니다.</p>
<h4 id="순환-의존-Circular-dependency"><a href="#순환-의존-Circular-dependency" class="headerlink" title="순환 의존(Circular dependency)"></a>순환 의존(Circular dependency)</h4><p>a는 b가 필요하고, b는 a를 필요로 하는 상황을 순환 의존이라고 합니다. 이경우 b모듈의 함수가 호출되면 a는 undefined가 됩니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//b.js:</span></div><div class="line">define([<span class="string">"require"</span>, <span class="string">"a"</span>],</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">require, a</span>) </span>&#123;</div><div class="line">       <span class="comment">// 여기서 인수로 전달받은 a객체는 null 입니다.</span></div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">title</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">"a"</span>).doSomething();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>위와 같은 상호 순환하는 의존관계는 드문경우이며, 의도하지 않았다면 이런 경우 설계를 다시 생각해 보는것이 좋을것입니다. 하지만, 간혹 이런 경우가 필요할 수 도 있으므로 오류를 피하기 위해 require()메스드를 이용해 나중에 모듈을 가져올 수 있습니다.</p>
<h4 id="JSONP-서비스-종속-기술하기"><a href="#JSONP-서비스-종속-기술하기" class="headerlink" title="JSONP 서비스 종속 기술하기"></a>JSONP 서비스 종속 기술하기</h4><p>JSONP는 외부 서비스를 자바스크립트에서 호출하는 기법입니다. 이것은 script태그를 통해 HTTP GET방식으로 작동합니다. requirejs에서 JSONP를 사용하기 위해서는 아래 예와 같이 URL끝부분에 callback파라미터의 값으로 define을 전달합니다. 그러면, 결과값이 define()의 인자값으로 전돨되어 모듈로 리턴됩니다.<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">require(["http://example.com/api/data.json?</div><div class="line">        callback=define"],</div><div class="line">    function (data) &#123;</div><div class="line">        //The data object will be the API response for the</div><div class="line">        //JSONP data call.</div><div class="line">        console.log(data);</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/assets/chanlee.jpeg"
               alt="chanlee" />
          <p class="site-author-name" itemprop="name">chanlee</p>
          <p class="site-description motion-element" itemprop="description">Computing and Programming issues</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">30</span>
              <span class="site-state-item-name">포스트</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">카테고리</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">태그</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/chanlee" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://twitter.com/chanlee" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chanlee</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'programmingnoteblog';
      var disqus_identifier = 'page/3/index.html';
      var disqus_title = "";
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  




  
  

  

  

  

  


</body>
</html>
